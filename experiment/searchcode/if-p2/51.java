* 0<x<p1 - a linear decent from 1.0 to the value of valAtp1
* p1<x<p2 - a cubic spline decent from (p1,valAtp1) to (p2,valAtp2)
if (x>=end) {
s = 0;
s_tag = 0;
return;
}
if (x>=p2) {
s = (x-end)*(x-end)*valAtp2/((p2-end)*(p2-end));

